
<!-- saved from url=(0054)https://xie.infoq.cn/article/182f59ec77450fde2f87e2354 -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!-- <geektime>1631674474153</geektime> -->
    
    
        <title>详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区</title>
        <meta name="description" content="作者｜进学审校｜泰一DTLS (Datagram Transport Layer Security) 基于 UDP 场景下数据包可能丢失或重新排序的现实情况下，为 UDP 定制和改进的 TLS 协议。" id="metadesc">
    
    <meta name="keywords" content="方法论,文化 方法,语言 开发,其他,WebRTC,DTLS,详解,传输,读懂,协议,搞定,通信安全,看完" id="metakeywords">
    <meta property="og:image" content="https://static001.infoq.cn/static/write/img/write-favicon.jpg">

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">
    
        <link rel="icon" type="image/png" sizes="32x32" href="https://static001.infoq.cn/static/write/img/write-favicon.jpg">
        <link rel="icon" type="image/png" sizes="16x16" href="https://static001.infoq.cn/static/write/img/write-favicon.jpg">
    
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="format-detection" content="telephone=no">
    <meta name="applicable-device" content="pc,mobile">
    <meta http-equiv="Cache-Control" content="no-transform">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <link rel="canonical" href="https://xie.infoq.cn/article/182f59ec77450fde2f87e2354">
    <meta property="og:title" content="详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区">
    <meta property="og:url" content="https://xie.infoq.cn/article/182f59ec77450fde2f87e2354">
    <meta property="og:description" content="作者｜进学审校｜泰一DTLS (Datagram Transport Layer Security) 基于 UDP 场景下数据包可能丢失或重新排序的现实情况下，为 UDP 定制和改进的 TLS 协议。">

    <script async="" src="./详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区_files/sensorsdata.min.js.下载" charset="UTF-8"></script><script src="./详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区_files/hm.js.下载"></script><script src="./详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区_files/hm.js(1).下载"></script><script async="" src="./详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区_files/analytics.js.下载"></script><script src="./详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区_files/push.js.下载"></script><script type="text/javascript" src="./详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区_files/jweixin-1.4.0.js.下载"></script>
    <script type="text/javascript" src="./详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区_files/bufferLogger.1.0.8.min.js.下载"></script>
    <script src="./详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区_files/dingtalk.open.js.下载"></script>
    
        <script type="text/javascript" src="./详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区_files/aliplayer-min.js.下载"></script>
        <script type="text/javascript" src="./详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区_files/hls.8361666e7e2690d988ff5fe775b62bbe.js.下载"></script>
    
    <script type="text/javascript">
        if (!('flex' in document.documentElement.style) && !navigator.userAgent.match(/spider|googlebot|bingbot|geekbang|yahoo! Slurp/i)) {
            window.location.href = '//static001.geekbang.org/static/common/browser_update/index.html'
        }
    </script>
    <script>
        (function(){
            var bp = document.createElement('script');
            var curProtocol = window.location.protocol.split(':')[0];
            if (curProtocol === 'https'){
                bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
            }
            else{
                bp.src = 'http://push.zhanzhang.baidu.com/push.js';
            }
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(bp, s);
        })();
    </script>
<link href="./详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区_files/app.58e0e007.css" rel="stylesheet"><link rel="stylesheet" type="text/css" href="./详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区_files/chunk-katex.26fbacea.css"><script charset="utf-8" src="./详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区_files/chunk-katex.a956ad4c.js.下载"></script><link rel="stylesheet" type="text/css" href="./详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区_files/chunk-geek-editor.7856a2e0.css"><script charset="utf-8" src="./详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区_files/chunk-geek-editor.a380be16.js.下载"></script><script charset="utf-8" src="./详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区_files/chunk-codemirror.89176e94.js.下载"></script><link rel="stylesheet" type="text/css" href="./详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区_files/chunk-5a59af0d.5179ef05.css"><script charset="utf-8" src="./详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区_files/chunk-5a59af0d.0aa7e703.js.下载"></script><link rel="stylesheet" type="text/css" href="./详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区_files/PageArticle.8d840f58.css"><script charset="utf-8" src="./详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区_files/PageArticle.11d4fe5e.js.下载"></script></head>

<body>
<div data-v-b110a92e="" data-v-0af02394="" id="layout" layout="" class="page-article-layout ready skin-base size-base" style="padding-bottom: 0px;"><div data-v-b110a92e="" layout-header-wrap="" class="layout-header-wrap"><div data-v-2bd1bdef="" data-v-b110a92e="" class="common-header-pc"><div data-v-2bd1bdef="" class="shim"></div><div data-v-2bd1bdef="" class="header"><div data-v-2bd1bdef="" class="wrap"><div data-v-2bd1bdef="" class="layout-content header-content"><div data-v-2bd1bdef="" class="logo"><a data-v-2bd1bdef="" href="https://www.infoq.cn/" class="main-logo"><img data-v-2bd1bdef="" src="./详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区_files/logo.b51e49df.png" alt="logo"></a><a data-v-2bd1bdef="" href="https://xie.infoq.cn/" class="sub-logo"><img data-v-2bd1bdef="" src="data:image/png;base64,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" alt="logo"></a></div><div data-v-2bd1bdef="" class="header-middle"><div data-v-2bd1bdef="" class="nav"><ul data-v-2bd1bdef=""><li data-v-2bd1bdef=""><a data-v-2bd1bdef="" href="https://xie.infoq.cn/" class="">首页</a></li><li data-v-2bd1bdef=""><!----><a data-v-2bd1bdef="" href="https://xie.infoq.cn/square/10" target="_blank" rel="" class=""> 活动🔥 </a></li><li data-v-2bd1bdef=""><!----><a data-v-2bd1bdef="" href="https://xie.infoq.cn/tag/3" target="_blank" rel="" class=""> Java </a></li><li data-v-2bd1bdef=""><!----><a data-v-2bd1bdef="" href="https://xie.infoq.cn/tag/211" target="_blank" rel="" class=""> 开源 </a></li><li data-v-2bd1bdef=""><!----><a data-v-2bd1bdef="" href="https://xie.infoq.cn/tag/238" target="_blank" rel="" class=""> 架构 </a></li><li data-v-2bd1bdef=""><!----><a data-v-2bd1bdef="" href="https://xie.infoq.cn/tag/92" target="_blank" rel="" class=""> 数据库 </a></li><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----></ul><div data-v-2bd1bdef="" class="more"> 全部标签 <i data-v-2bd1bdef="" class="iconfont"></i></div></div><div data-v-2bd1bdef="" class="search-container"><div data-v-2bd1bdef="" class="search-wrap"><input data-v-2bd1bdef="" type="text" placeholder="搜索" class="search-input"><span data-v-2bd1bdef="" class="search-btn iconfont"></span></div></div><!----><div data-v-2bd1bdef="" class="write-btn-warp"><div data-v-2bd1bdef="" gk-button="" gkbtn-color="green" gkbtn-size="small" class="write-btn Button_button_3onsJ"> 写点什么 </div><div data-v-2bd1bdef="" class="scene" style="display: none;"><h4 data-v-2bd1bdef=""><i data-v-2bd1bdef="" class="iconfont"></i>创作场景</h4><div data-v-2bd1bdef="" class="close"><i data-v-2bd1bdef="" class="iconfont"></i></div><ul data-v-2bd1bdef=""><li data-v-2bd1bdef="">记录自己日常工作的实践、心得</li><li data-v-2bd1bdef="">发表对生活和职场的感悟</li><li data-v-2bd1bdef="">针对感兴趣的事件发表随笔或者杂谈</li><li data-v-2bd1bdef="">从0到1详细介绍你掌握的一门语言、一个技术，或者一个兴趣、爱好</li><li data-v-2bd1bdef="">或者，就直接把你的个人博客、公众号直接搬到这里</li></ul></div></div></div><div data-v-2bd1bdef="" class="account"><span data-v-2bd1bdef="" class="route">登录</span><span data-v-2bd1bdef="" class="line"></span><span data-v-2bd1bdef="" class="route">注册</span></div></div></div><div data-v-2bd1bdef="" class="more-tags"><div data-v-2bd1bdef="" class="inner-content"><div data-v-4300d745="" data-v-2bd1bdef="" class="com-label-list"><a data-v-4426e0e8="" data-v-4300d745="" href="https://xie.infoq.cn/tag/84" com-label-title="" class="com-label-title">MySQL</a><a data-v-4426e0e8="" data-v-4300d745="" href="https://xie.infoq.cn/tag/9434" com-label-title="" class="com-label-title">OpenHarmony</a><a data-v-4426e0e8="" data-v-4300d745="" href="https://xie.infoq.cn/tag/130" com-label-title="" class="com-label-title">云计算</a><a data-v-4426e0e8="" data-v-4300d745="" href="https://xie.infoq.cn/tag/232" com-label-title="" class="com-label-title">程序员</a><a data-v-4426e0e8="" data-v-4300d745="" href="https://xie.infoq.cn/tag/1178" com-label-title="" class="com-label-title">行业资讯</a><a data-v-4426e0e8="" data-v-4300d745="" href="https://xie.infoq.cn/tag/303" com-label-title="" class="com-label-title">算法</a><a data-v-4426e0e8="" data-v-4300d745="" href="https://xie.infoq.cn/tag/8" com-label-title="" class="com-label-title">Python</a><a data-v-4426e0e8="" data-v-4300d745="" href="https://xie.infoq.cn/tag/60" com-label-title="" class="com-label-title">人工智能</a><a data-v-4426e0e8="" data-v-4300d745="" href="https://xie.infoq.cn/tag/55" com-label-title="" class="com-label-title">区块链</a><a data-v-4426e0e8="" data-v-4300d745="" href="https://xie.infoq.cn/tag/182" com-label-title="" class="com-label-title">Linux</a><a data-v-4426e0e8="" data-v-4300d745="" href="https://xie.infoq.cn/tag/371" com-label-title="" class="com-label-title">前端</a><a data-v-4426e0e8="" data-v-4300d745="" href="https://xie.infoq.cn/tag/264" com-label-title="" class="com-label-title">个人成长</a><a data-v-4426e0e8="" data-v-4300d745="" href="https://xie.infoq.cn/tag/283" com-label-title="" class="com-label-title">面试</a><a data-v-4426e0e8="" data-v-4300d745="" href="https://xie.infoq.cn/tag/1502" com-label-title="" class="com-label-title">架构师</a><a data-v-4426e0e8="" data-v-4300d745="" href="https://xie.infoq.cn/tag/222" com-label-title="" class="com-label-title">编程</a><a data-v-4426e0e8="" data-v-4300d745="" href="https://xie.infoq.cn/tag/4909" com-label-title="" class="com-label-title">企业动态</a><a data-v-4426e0e8="" data-v-4300d745="" href="https://xie.infoq.cn/tag/1937" com-label-title="" class="com-label-title">新基建</a><a data-v-4426e0e8="" data-v-4300d745="" href="https://xie.infoq.cn/tag/361" com-label-title="" class="com-label-title">敏捷</a><a data-v-4426e0e8="" data-v-4300d745="" href="https://xie.infoq.cn/tag/497" com-label-title="" class="com-label-title">安全</a><a data-v-4426e0e8="" data-v-4300d745="" href="https://xie.infoq.cn/tag/201" com-label-title="" class="com-label-title">读书笔记</a><a data-v-4426e0e8="" data-v-4300d745="" href="https://xie.infoq.cn/tag/203" com-label-title="" class="com-label-title">高效工作</a><a data-v-4426e0e8="" data-v-4300d745="" href="https://xie.infoq.cn/tag/204" com-label-title="" class="com-label-title">团队管理</a><a data-v-4426e0e8="" data-v-4300d745="" href="https://xie.infoq.cn/tag/192" com-label-title="" class="com-label-title">创业</a><a data-v-4426e0e8="" data-v-4300d745="" href="https://xie.infoq.cn/tag/207" com-label-title="" class="com-label-title">生涯规划</a><a data-v-4426e0e8="" data-v-4300d745="" href="https://xie.infoq.cn/tag/492" com-label-title="" class="com-label-title">知识管理</a><a data-v-4426e0e8="" data-v-4300d745="" href="https://xie.infoq.cn/tag/317" com-label-title="" class="com-label-title">运维</a><a data-v-4426e0e8="" data-v-4300d745="" href="https://xie.infoq.cn/tag/400" com-label-title="" class="com-label-title">产品经理</a><a data-v-2bd1bdef="" data-v-4300d745="" href="https://xie.infoq.cn/tag" target="_blank" class="more-tag com-label-title"> 查看更多 <i data-v-2bd1bdef="" data-v-4300d745="" class="iconfont"></i></a></div></div></div></div></div></div><div data-v-b110a92e="" inner-content="" class="inner-content"><!----><!----><!----><div data-v-0af02394="" data-v-b110a92e="" class="layout-content article-content"><div data-v-0af02394="" class="article-fixed-wrap" data-v-b110a92e="" style="width: 150px;"><div data-v-0af02394="" class="side-operation" style="top: 91px;"><div data-v-72733e04="" data-v-0af02394="" class="widget-operation side" wxshareurl="https://xie.infoq.cn/article/182f59ec77450fde2f87e2354" authorinfo="[object Object]"><div data-v-72733e04="" class="toggle-menu btn"><i data-v-72733e04="" class="iconfont"></i></div><div data-v-72733e04="" class="like btn"><i data-v-72733e04="" class="iconfont"></i><!----></div><div data-v-72733e04="" class="favorite btn"><i data-v-72733e04="" class="iconfont"></i></div><div data-v-72733e04="" class="comment btn"><i data-v-72733e04="" class="iconfont"></i></div><div data-v-72733e04="" class="weixin btn"><span data-v-72733e04="" class="gkui-popup share-popup-left share-popup"><i data-v-72733e04="" class="iconfont"></i><!----></span></div><div data-v-72733e04="" class="weibo btn"><i data-v-72733e04="" class="iconfont"></i></div><div data-v-72733e04="" class="horde btn"><i data-v-72733e04="" class="iconfont"></i></div><!----></div></div></div><div data-v-0af02394="" data-v-b110a92e="" class="main"><!----><!----><h1 data-v-0af02394="" data-v-b110a92e="" class="article-title">详解 WebRTC 传输安全机制：一文读懂 DTLS 协议</h1><div data-v-0af02394="" data-v-b110a92e="" class="author-information"><div data-v-0af02394="" data-v-b110a92e="" class="row"><div data-v-0af02394="" data-v-b110a92e="" class="author-name"> 作者：<span data-v-3bc80670="" data-v-6281d13f="" data-v-0af02394="" class="ctn" data-v-b110a92e=""><a data-v-3bc80670="" rel="nofollow" com-author-name="" class="com-author-name">阿里云视频云</a><!----></span></div></div><div data-v-0af02394="" data-v-b110a92e="" class="row article-head"><ul data-v-0af02394="" data-v-b110a92e="" class="read-time"><li data-v-0af02394="" data-v-b110a92e="">2021 年 5 月 07 日</li><li data-v-0af02394="" data-v-b110a92e=""><p data-v-0af02394="" data-v-b110a92e="" class="time-style">本文字数：6775 字 </p><!----><p data-v-0af02394="" data-v-b110a92e="" class="time-style">阅读完需：约 22 分钟</p></li></ul></div></div><div data-v-0af02394="" data-v-b110a92e="" class="article-cover"><img data-v-0af02394="" data-v-b110a92e="" src="./详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区_files/c5410895d50f76f4b0a97c32825fe117.png" alt="详解 WebRTC 传输安全机制：一文读懂 DTLS 协议"></div><div data-v-0af02394="" data-v-b110a92e="" class="article-detaile"><div data-v-499c3731="" data-v-0af02394="" class="article-preview-content size-base" data-v-b110a92e=""><div data-v-499c3731="" data-type="doc" class="article-preview"><div contenteditable="false" class="ProseMirror"><p data-type="paragraph">作者｜进学</p><p data-type="paragraph">审校｜泰一</p><p data-type="paragraph"><br></p><p data-type="paragraph">DTLS (Datagram Transport Layer Security) 基于 UDP 场景下数据包可能丢失或重新排序的现实情况下，为 UDP 定制和改进的 TLS 协议。在 WebRTC 中使用 DTLS 的地方包括两部分：协商和管理 <a href="https://xie.infoq.cn/article/182f59ec77450fde2f87e2354" title="" data-type="link">SRTP</a> 密钥和为 <a href="https://xie.infoq.cn/article/182f59ec77450fde2f87e2354" title="" data-type="link">DataChannel</a> 提供加密通道。</p><p data-type="paragraph"><br></p><div data-type="image"><div data-content="" data-style-width="75%" data-style-bordertype="none"><img src="./详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区_files/53e7d438332ef7a0432f28e943ef270b.png"> <!----></div></div><p data-type="paragraph"><br></p><p data-type="paragraph">本文结合实际数据包分析 WebRTC 使用 DTLS 进行 SRTP 密钥协商的流程。并对在实际项目中使用 DTLS 遇到的问题进行总结。</p><h2 data-id="heading0" data-type="heading" top="530">DTLS 协议简介</h2><p data-type="paragraph">在分析 DTLS 在 WebRTC 中的应用之前，先介绍下 DTLS 协议的基本原理。DTLS 协议由两层组成: Record 协议 和 Handshake 协议</p><p data-type="paragraph"><br></p><ol data-type="numberedlist"><li><p data-number="1" data-type="paragraph">Record 协议：使用对称密钥对传输数据进行加密，并使用 HMAC 对数据进行完整性校验，实现了数据的安全传输。</p></li><li><p data-number="2" data-type="paragraph">Handshake 协议：使用非对称加密算法，完成 Record 协议使用的对称密钥的协商。</p></li></ol><h3 data-id="heading1" data-type="heading" top="784">HandShake</h3><p data-type="paragraph">TLS 握手协议流程如下，参考 <a href="https://xie.infoq.cn/link?target=https%3A%2F%2Ftools.ietf.org%2Fhtml%2Frfc5246%3Fspm%3Da2c6h.12873639.0.0.4c9a21a8kxR03N%23section-7.3" title="" data-type="link">RFC5246</a><br></p><p data-type="paragraph"><br></p><div data-type="image"><div data-content="" data-style-width="75%" data-style-bordertype="none"><img src="./详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区_files/79aad8d4f872b627e92a68aa10a3570b.png"> <!----></div></div><p data-type="paragraph"><br></p><p data-type="paragraph">DTLS 握手协议流程如下，参考 <a href="https://xie.infoq.cn/link?target=https%3A%2F%2Ftools.ietf.org%2Fhtml%2Frfc6347%3Fspm%3Da2c6h.12873639.0.0.4c9a21a8kxR03N%23section-4.2.4" title="" data-type="link">RFC6347</a><br></p><p data-type="paragraph"><br></p><div data-type="image"><div data-content="" data-style-width="75%" data-style-bordertype="none"><img src="./详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区_files/b712f7706ccc18e3628459d6d509939a.png"> <!----></div></div><p data-type="paragraph"><br></p><div data-type="image"><div data-content="" data-style-width="75%" data-style-bordertype="none"><img src="./详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区_files/c5477a5168b2f8dea96064d865599dea.png"> <!----></div></div><p data-type="paragraph"><br></p><p data-type="paragraph">TLS 和 DTLS 的握手过程基本上是一致的，差别以及特别说明如下：</p><p data-type="paragraph"><br></p><ul data-type="bulletedlist"><li><p data-type="paragraph">DTLS 中 <a href="https://xie.infoq.cn/link?target=https%3A%2F%2Ftools.ietf.org%2Fhtml%2Frfc6347" title="" data-type="link">HelloVerifyRequest</a> 是为防止 DoS 攻击增加的消息。</p></li><li><p data-type="paragraph">TLS 没有发送 <a href="https://xie.infoq.cn/link?target=https%3A%2F%2Ftools.ietf.org%2Fhtml%2Frfc5246%23section-7.4.4" title="" data-type="link">CertificateRequest</a>，这个也不是必须的，是反向验证即服务器验证客户端。</p></li><li><p data-type="paragraph">DTLS 的 RecordLayer 新增了 SequenceNumber 和 Epoch，以及 ClientHello 中新增了 Cookie，以及 Handshake 中新增了 Fragment 信息（防止超过 UDP 的 MTU），都是为了适应 UDP 的丢包以及容易被攻击做的改进。参考 <a href="https://xie.infoq.cn/link?target=https%3A%2F%2Ftools.ietf.org%2Fhtml%2Frfc6347%23section-4.2.2" title="" data-type="link">RFC 6347</a><br></p></li><li><p data-type="paragraph">DTLS 最后的 Alert 是将客户端的 Encrypted Alert 消息，解密之后直接响应给客户端的，实际上 Server 应该回应加密的消息，这里我们的服务器回应明文是为了解析客户端加密的那个 Alert 包是什么。</p></li></ul><p data-type="paragraph"><br></p><p data-type="paragraph">RecordLayer 协议是和 DTLS 传输相关的协议，UDP 之上是 RecordLayer，RecordLayer 之上是 Handshake 或 ChangeCipherSpec 或 ApplicationData。RecordLayer 协议定义参考 <a href="https://xie.infoq.cn/link?target=https%3A%2F%2Ftools.ietf.org%2Fhtml%2Frfc4347" title="" data-type="link">RFC4347</a>，实际上有三种 RecordLayer 的包:</p><p data-type="paragraph"><br></p><ul data-type="bulletedlist"><li><p data-type="paragraph"><code data-type="codeinline">DTLSPlaintext</code>，DTLS 明文的 RecordLayer。</p></li><li><p data-type="paragraph"><code data-type="codeinline">DTLSCompressed</code>，压缩的数据，一般不用。</p></li><li><p data-type="paragraph"><code data-type="codeinline">DTLSCiphertext</code>，加密的数据，在 ChangeCipherSpec 之后就是这种了。</p></li></ul><p data-type="paragraph"><br></p><p data-type="paragraph">没有明确的字段说明是哪种消息，不过可以根据上下文以及内容判断。比如 ChangeCipherSpec 是可以通过类型，它肯定是一个 Plaintext。除了 Finished 的其他握手，一般都是 Plaintext。</p><h2 data-id="heading2" data-type="heading" top="1727">SRTP 密钥协商</h2><h3 data-id="heading3" data-type="heading" top="1801">角色协商</h3><p data-type="paragraph">在 DTLS 协议，通信的双方有 <code data-type="codeinline">Client</code> 和 <code data-type="codeinline">Server</code> 之分。在 WebRTC 中 DTLS 协商的身份是在 <code data-type="codeinline">SDP</code> 中描述的。描述如下，参考 <a href="https://xie.infoq.cn/link?target=https%3A%2F%2Fwebrtchacks.com%2Fsdp-anatomy%2F" title="" data-type="link">SDP-Anatomy</a> 中 DTLS 参数</p><p data-type="paragraph"><br></p><div data-type="codeblock"><div data-codeblock-wrap=""><div data-codeblock-codes=""><div class="simplebar" data-simplebar="init"><div class="simplebar-wrapper" style="margin: 0px;"><div class="simplebar-height-auto-observer-wrapper"><div class="simplebar-height-auto-observer"></div></div> <div class="simplebar-mask"><div class="simplebar-offset" style="right: 0px; bottom: 0px;"><div class="simplebar-content-wrapper" style="height: 100%; overflow: hidden scroll;"><div class="simplebar-content" style="padding: 0px;"><div><pre data-origin="pm_code_preview" lang="text"><code data-type="codeline">a=setup:active</code></pre></div></div></div></div></div> <div class="simplebar-placeholder" style="width: 770px; height: 30px;"></div></div> <div class="simplebar-track simplebar-horizontal" style="visibility: hidden;"><div class="simplebar-scrollbar simplebar-visible" style="width: 0px; display: none;"></div></div> <div class="simplebar-track simplebar-vertical" style="visibility: visible;"><div class="simplebar-scrollbar simplebar-visible" style="height: 0px; display: none;"></div></div></div></div> <div data-codeblock-copy="">复制代码</div> <div data-codeblock-index=""><div data-codeblock-number="1"></div></div></div></div><p data-type="paragraph"><br></p><p data-type="paragraph"><code data-type="codeinline">setup</code> 属性在 <a href="https://xie.infoq.cn/link?target=https%3A%2F%2Ftools.ietf.org%2Fhtml%2Frfc4145%23section-4.1" title="" data-type="link">RFC4145</a>，</p><p data-type="paragraph"><br></p><p data-type="paragraph">setup:active，作为 client，主动发起协商</p><p data-type="paragraph"><br></p><p data-type="paragraph">setup:passive, 作为 sever，等待发起协商</p><p data-type="paragraph"><br></p><p data-type="paragraph">setup:actpass, 作为 client，主动发起协商。作为 server，等待发起协商。</p><h3 data-id="heading4" data-type="heading" top="2297">算法协商 - Hello 消息</h3><p data-type="paragraph">ClienHello 和 ServerHello 协商 DTLS 的 Version、CipherSuites、Random、以及 Extensions。</p><div data-type="image"><div data-content="" data-style-width="75%" data-style-bordertype="none"><img src="./详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区_files/8b5e5dbadbcbd9d2e876fc7f39973da6.png"> <!----></div></div><p data-type="paragraph"><br></p><div data-type="image"><div data-content="" data-style-width="75%" data-style-bordertype="none"><img src="./详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区_files/274c57b90bc0bd9960818c717330ebaf.png"> <!----></div></div><p data-type="paragraph"><br></p><ul data-type="bulletedlist"><li><p data-type="paragraph"><code data-type="codeinline">Version</code>：Client 给出自己能支持的、或者要使用的最高版本，比如 DTLS1.2。Server 收到这个信息后，根据自己能支持的、或者要使用的版本回应，比如 DTLS1.0。最终以协商的版本也就是 DTLS1.0 为准。</p></li><li><p data-type="paragraph"><code data-type="codeinline">CipherSuites</code>：Client 给出自己能支持的加密套件 CipherSuites，Server 收到后选择自己能支持的回应一个，比如 TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA (0xc014)，加密套件确定了证书的类型、密钥生成算法、摘要算法等。</p></li><li><p data-type="paragraph"><code data-type="codeinline">Random</code>：双方的随机数，参与到生成 MasterSecret。MasterSecret 会用来生成主密钥，导出 SRTP 密钥。详见 [导出 SRTP 密钥]</p></li><li><p data-type="paragraph"><code data-type="codeinline">Extensions</code>：Client 给出自己要使用的扩展协议，Server 可以回应自己支持的。比如 Client 虽然设置了 SessionTicket TLS 这个扩展，但是 Server 没有回应，所以最终并不会使用这个扩展。</p></li></ul><h4 data-id="heading5" data-type="heading" top="2773">Cipher Suite</h4><div data-type="image"><div data-content="" data-style-width="75%" data-style-bordertype="none"><img src="./详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区_files/3ae8b9e98084e0bfa5b5d284f0ea2064.png"> <!----></div></div><p data-type="paragraph"><br></p><p data-type="paragraph">在 Hello 消息中加密套接字使用 <code data-type="codeinline">IANA</code> 中的注册的名字。IANA 名字由 Protocol，Key Exchange Algorithm，Authentication Algorithm，Encryption Algorithm ，Hash Algorithm 的描述组成。例如，TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 的含义如下：</p><p data-type="paragraph"><br></p><ul data-type="bulletedlist"><li><p data-type="paragraph"><code data-type="codeinline">Protocol</code>: Transport Layer Security (TLS)</p></li><li><p data-type="paragraph"><code data-type="codeinline">Key Exchange</code>: Elliptic Curve Diffie-Hellman Ephemeral (ECDHE)</p></li><li><p data-type="paragraph"><code data-type="codeinline">Authentication</code>: Rivest Shamir Adleman algorithm (RSA)</p></li><li><p data-type="paragraph"><code data-type="codeinline">Encryption</code>: Advanced Encryption Standard with 128bit key in Galois/Counter mode (AES 128 GCM)</p></li><li><p data-type="paragraph"><code data-type="codeinline">Hash</code>: Secure Hash Algorithm 256 (SHA256)</p></li></ul><p data-type="paragraph"><br></p><blockquote data-type="blockquote"><p data-type="paragraph">加密套接字在 <a href="https://xie.infoq.cn/link?target=https%3A%2F%2Fciphersuite.info%2Fcs%2F" title="" data-type="link">ciphersuite.info</a> 可以查到。在查到 IANA 名字的同时，也可以查到在 OpenSSL 中的名字。TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 在 OpenSSL 中的名字为 ECDHE-RSA-AES128-GCM-SHA256Note: 关于 Authentication (认证)、KeyExchange (密钥交换)、Encryption (加密)、MAC (Message Authentication Code) 消息摘要等，可以参考<a href="https://xie.infoq.cn/link?target=https%3A%2F%2Fwww.zhihu.com%2Fquestion%2F25116415" title="" data-type="link"> RSA 密钥协商</a>。</p></blockquote><h4 data-id="heading6" data-type="heading" top="3320">Extension</h4><p data-type="paragraph">DTLS 的扩展协议，是在 ClientHello 和 ServerHello 的 Extensions 信息中指定的，所有的 TLS 扩展参考 <a href="https://xie.infoq.cn/link?target=https%3A%2F%2Fwww.iana.org%2Fassignments%2Ftls-extensiontype-values%2Ftls-extensiontype-values.xhtml" title="" data-type="link">TLS Extensions</a>。下面列出几个 WebRTC 用到的扩展：</p><p data-type="paragraph"><br></p><ul data-type="bulletedlist"><li><p data-type="paragraph"><code data-type="codeinline">use_srtp</code>: DTLS 握手完成后 (Finished)，使用 SRTP 传输数据，DTLS 生成 SRTP 的密钥。 <a href="https://xie.infoq.cn/link?target=https%3A%2F%2Ftools.ietf.org%2Fhtml%2Frfc5764" title="" data-type="link">RFC5764</a>。ClientHello 中的扩展信息定义了 <a href="https://xie.infoq.cn/link?target=https%3A%2F%2Ftools.ietf.org%2Fhtml%2Frfc5764%23page-8" title="" data-type="link">RFC5764 4.1.2.  SRTP Protection Profiles</a> 和 <a href="https://xie.infoq.cn/link?target=https%3A%2F%2Ftools.ietf.org%2Fhtml%2Frfc5764%23section-4.1.3" title="" data-type="link">srtp_mki</a>。</p></li><li><div data-type="image"><div data-content=""><img src="./详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区_files/1618149732986-7902bd92-d4f4-4dc1-913d-3491d4243cdb.png"> <!----></div></div></li><li><p data-type="paragraph"><code data-type="codeinline">supported_groups</code>，原来的名字为 elliptic_curves，描述支持的 ECC 加密算法，参考 <a href="https://xie.infoq.cn/link?target=https%3A%2F%2Ftools.ietf.org%2Fhtml%2Frfc8422%23section-5.1.1" title="" data-type="link">RFC8422 5.1.1.Supported Elliptic Curves Extension</a>，一般用的是 secp256r1。</p></li><li><div data-type="image"><div data-content=""><img src="./详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区_files/1618149817717-a840a0ed-dc79-41f7-99c0-cff1b8d09284.png"> <!----></div></div></li><li><p data-type="paragraph"><code data-type="codeinline">signature_algorithms</code>，DTLS1.2 的扩展，指定使用的 Hash 和 Signature 算法，参考 <a href="https://xie.infoq.cn/link?target=https%3A%2F%2Ftools.ietf.org%2Fhtml%2Frfc5246%23section-7.4.1.4.1" title="" data-type="link">RFC5246 7.4.1.4.1.  Signature Algorithms</a>。DTLS1.0，RSA 用的是 md5sha1 摘要算法，DSA 用的是 sha1 摘要算法。</p></li><li><div data-type="image"><div data-content=""><img src="./详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区_files/1618149874234-54bf92cc-87ff-48e5-a02e-910576989a64.png"> <!----></div></div></li><li><p data-type="paragraph"><code data-type="codeinline">extended_master_secret</code>，扩展 MasterSecret 的生成方式，参考 <a href="https://xie.infoq.cn/link?target=https%3A%2F%2Ftools.ietf.org%2Fhtml%2Frfc7627" title="" data-type="link">RFC7627</a>。在 KeyExchange 中，会加入一些常量来生成 MasterSecret。TLS 定义了扩展方式，如果用这个扩展，DTLS 的方式和 TLS 会有些不同。</p></li><li><p data-type="paragraph"><code data-type="codeinline">renegotiation_info</code>, 参考 <a href="https://xie.infoq.cn/link?target=https%3A%2F%2Ftools.ietf.org%2Fhtml%2Frfc5746%23section-3.2" title="" data-type="link">RFC5746</a><br></p></li></ul><p data-type="paragraph"><br></p><p data-type="paragraph">除了这些扩展协议，和 SRTP 密钥导出相关的还有：</p><p data-type="paragraph"><br></p><blockquote data-type="blockquote"><p data-type="paragraph">RFC5705: Keying Material Exporters for Transport Layer Security (TLS)，DTLS 如何从 MasterSecret 导出 Key，比如 SRTP 的 Key。RFC5764: DTLS Extension to Establish Keys for the SRTP，DTLS 的 use_srtp 扩展的详细规范，包括 ClientHello 扩展定义、Profile 定义、Key 的计算。</p></blockquote><h3 data-id="heading7" data-type="heading" top="3993">身份验证 - Certificate</h3><p data-type="paragraph"><br></p><div data-type="image"><div data-content="" data-style-width="75%" data-style-bordertype="none"><img src="./详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区_files/0171be1632396a50bb9f9ac8e75a22b2.png"> <!----></div></div><p data-type="paragraph"><br></p><p data-type="paragraph">数字证书是由一些公认可信的证书颁发机构签发的，不易伪造。数字证书可以用于接收者验证对端的身份，接收者收到某个对端的证书时，会对签名颁发机构的数字签名进行检查，一般来说，接收者事先就会预先安装很多常用的签名颁发机构的证书（含有公开密钥），利用预先的公开密钥可以对签名进行验证。</p><p data-type="paragraph"><br></p><p data-type="paragraph">Server 端通过 Hello 消息，协商交换密钥的方法后，将 Server 证书发送给 Client，用于 Client 对 Server 的身份进行校验。Server 发送的证书必须适用于协商的 KeyExchange 使用的加密套接字，以及 Hello 消息扩展中描述的 Hash/Signature 算法对。</p><p data-type="paragraph"><br></p><p data-type="paragraph">在 WebRTC 中，通信的双方通常将无法获得由知名根证书颁发机构 (CA) 签名的身份验证证书，自签名证书通常是唯一的选择。<a href="https://xie.infoq.cn/link?target=https%3A%2F%2Ftools.ietf.org%2Fhtml%2Frfc4572" title="" data-type="link">RFC4572</a> 定义一种机制，通过在 <code data-type="codeinline">SDP</code> 中增加自签名证书的安全哈希，称为 "证书指纹"，在保证 SDP 安全传输的前提下，如果提供的证书的指纹与 <code data-type="codeinline">SDP</code> 中的指纹匹配，则可以信任自签名证书。在实际的应用场景中，SDP 在安全的信令通道 (https) 完成交换的，SDP 的安全完整是可以做到的。这样在 DTLS 协商过程中，可以使用证书的指纹，完成通信双方的身份校验。证书指纹在 SDP 中的描述如下，参考 <a href="https://xie.infoq.cn/link?target=https%3A%2F%2Fwebrtchacks.com%2Fsdp-anatomy%2F" title="" data-type="link">SDP-Anatomy</a>  中 DTLS 参数</p><p data-type="paragraph"><br></p><div data-type="codeblock"><div data-codeblock-wrap=""><div data-codeblock-codes=""><div class="simplebar" data-simplebar="init"><div class="simplebar-wrapper" style="margin: 0px;"><div class="simplebar-height-auto-observer-wrapper"><div class="simplebar-height-auto-observer"></div></div> <div class="simplebar-mask"><div class="simplebar-offset" style="right: 0px; bottom: 0px;"><div class="simplebar-content-wrapper" style="height: 100%; overflow: scroll;"><div class="simplebar-content" style="padding: 0px;"><div><pre data-origin="pm_code_preview" lang="text"><code data-type="codeline">a=fingerprint:sha-256 49:66:12:17:0D:1C:91:AE:57:4C:C6:36:DD:D5:97:D2:7D:62:C9:9A:7F:B9:A3:F4:70:03:E7:43:91:73:23:5E</code></pre></div></div></div></div></div> <div class="simplebar-placeholder" style="width: 770px; height: 30px;"></div></div> <div class="simplebar-track simplebar-horizontal" style="visibility: visible;"><div class="simplebar-scrollbar simplebar-visible" style="width: 649px; display: block; transform: translate3d(0px, 0px, 0px);"></div></div> <div class="simplebar-track simplebar-vertical" style="visibility: visible;"><div class="simplebar-scrollbar simplebar-visible" style="height: 0px; display: none;"></div></div></div></div> <div data-codeblock-copy="">复制代码</div> <div data-codeblock-index=""><div data-codeblock-number="1"></div></div></div></div><h3 data-id="heading8" data-type="heading" top="4658">密钥交换 - KeyExchange</h3><p data-type="paragraph">ServerKeyExchange 用来将 Server 端使用的公钥，发送给 Client 端。分为两种情况：</p><p data-type="paragraph"><br></p><ol data-type="numberedlist"><li><p data-number="1" data-type="paragraph"><code data-type="codeinline">RSA</code> 算法：如果服务端使用的是 RSA 算法，可以不发送这个消息，因为 RSA 算法使用的公钥已经在 Certificate 中描述。</p></li><li><p data-number="2" data-type="paragraph"><code data-type="codeinline">DH</code> 算法，是根据对方的公钥和自己私钥计算共享密钥。因为 Client 和 Server 都只知道自己的私钥，和对方的公钥；而他们的私钥都不同，根据特殊的数学特性，他们能计算出同样的共享密钥。关于 DH 算法如何计算出共享密钥，参考 <a href="https://xie.infoq.cn/link?target=http%3A%2F%2Fwww.voidcn.com%2Farticle%2Fp-rgubrwfd-bpg.html" title="" data-type="link">DH 算法</a>。</p></li></ol><p data-type="paragraph"><br></p><div data-type="image"><div data-content="" data-style-width="75%" data-style-bordertype="none"><img src="./详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区_files/c85d18e054ebb5ab3e35fa0baa213afd.png"> <!----></div></div><p data-type="paragraph"><br></p><p data-type="paragraph">ClientKeyExchange 用来将 Client 使用的公钥，发送给 Server 端。</p><p data-type="paragraph"><br></p><ol data-type="numberedlist"><li><p data-number="1" data-type="paragraph"><code data-type="codeinline">RSA</code> 算法：如果密钥协商使用的 RSA 算法，发送使用 server 端 RSA 公钥，对 premaster secret 加密发送给 server 端。</p></li><li><p data-number="2" data-type="paragraph"><code data-type="codeinline">DH</code> 算法：如果密钥协商使用的 DH 算法，并且在证书中没有描述，在将客户端使用的 DH 算法公钥发送给 Server 端，以便计算出共享密钥。KeyExchange 的结果是，Client 和 Server 获取到了 RSA Key， 或通过 DH 算法计算出共享密钥。详见 [导出 SRTP 密钥] 的过程</p></li></ol><h3 data-id="heading9" data-type="heading" top="5235">证书验证 - CertificateVerify</h3><p data-type="paragraph">使用 ClientRequest 中描述的 Hash/Signature 算法，对收到和发送的 HandShake 消息签名发送个 Server。Server 端对签名进行校验。</p><p data-type="paragraph"><br></p><div data-type="image"><div data-content="" data-style-width="75%" data-style-bordertype="none"><img src="./详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区_files/5ffabb189a83c1c19b72f0fd44ebe84f.png"> <!----></div></div><p data-type="paragraph"><br></p><h3 data-id="heading10" data-type="heading" top="5444">加密验证 - Finished</h3><p data-type="paragraph">当 Server 和 Client 完成对称密钥的交换后，通过 <code data-type="codeinline">ChangeCipherSpec</code> 通知对端进入加密阶段，epoch 加 1。</p><p data-type="paragraph"><br></p><p data-type="paragraph">随后 Client 使用交换的密钥，对 "client finished" 加密，使用 Finished 消息，发送给服务端。Server 使用交换的密钥，对 "server finished" 进行加密发送给客户端。一旦验证了 finished 消息后，就可以正常通信了。</p><p data-type="paragraph"><br></p><div data-type="image"><div data-content="" data-style-width="75%" data-style-bordertype="none"><img src="./详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区_files/e43e056a9efafee909b1ca869a3f2045.png"> <!----></div></div><p data-type="paragraph"><br></p><h2 data-id="heading11" data-type="heading" top="5715">导出 SRTP 密钥</h2><p data-type="paragraph">上面介绍了 DTLS 的过程，以下通过结合上面例子给出的实际数据，详细说明 SRTP 密钥的导出步骤。</p><h3 data-id="heading12" data-type="heading" top="5819">协商后的加密算法</h3><p data-type="paragraph">加密套件：TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 (0xc02f)椭圆曲线算法为：secp256r1，椭圆曲线的点压缩算法为：uncompressed。椭圆曲线算法的基础知识的介绍在 <a href="https://xie.infoq.cn/link?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F66794410" title="" data-type="link">ECC 椭圆曲线加密算法 - ECDH,ECDHE,ECDSA</a> ，由文档中我们可以知道，确定椭圆曲线加密算法有如下参数：</p><p data-type="paragraph"><br></p><ul data-type="bulletedlist"><li><p data-type="paragraph">素数 p，用于确定有限域的范围</p></li><li><p data-type="paragraph">椭圆曲线方程中的 a，b 参数</p></li><li><p data-type="paragraph">用于生成子群的的基点 G</p></li><li><p data-type="paragraph">子群的阶 n</p></li><li><p data-type="paragraph">子群的辅助因子 h 定义为<code data-type="codeinline">六元组(p,a,b,G,n,h)</code><br></p></li></ul><p data-type="paragraph"><br></p><p data-type="paragraph">通过在 <a href="https://xie.infoq.cn/link?target=http%3A%2F%2Fwww.secg.org%2Fsec2-v2.pdf" title="" data-type="link">SECG-SEC2 2.4.2 Recommended Parameters secp256r1</a>  中可以查到 secp256r1 对应的参数如下：</p><p data-type="paragraph"><br></p><div data-type="codeblock"><div data-codeblock-wrap=""><div data-codeblock-codes=""><div class="simplebar" data-simplebar="init"><div class="simplebar-wrapper" style="margin: 0px;"><div class="simplebar-height-auto-observer-wrapper"><div class="simplebar-height-auto-observer"></div></div> <div class="simplebar-mask"><div class="simplebar-offset" style="right: 0px; bottom: 0px;"><div class="simplebar-content-wrapper" style="height: 100%; overflow: scroll;"><div class="simplebar-content" style="padding: 0px;"><div><pre data-origin="pm_code_preview" lang="text"><code data-type="codeline">secp256r1使用的参数如下：</code><code data-type="codeline">使用的素数p:</code><code data-type="codeline">p=FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF</code><code data-type="codeline">=2224(232−1)+2192+296−1</code><code data-type="codeline">椭圆曲线E:y^2=x^3+ax+b的参数定义如下：</code><code data-type="codeline">a=FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC</code><code data-type="codeline">b=5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B</code><code data-type="codeline">基点G的非压缩格式：</code><code data-type="codeline">G=046B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C2964FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5</code><code data-type="codeline">有限域的阶n:</code><code data-type="codeline">n=FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551</code><code data-type="codeline">辅助因子h:</code><code data-type="codeline">h=01</code><code data-type="codeline"><br></code></pre></div></div></div></div></div> <div class="simplebar-placeholder" style="width: 770px; height: 290px;"></div></div> <div class="simplebar-track simplebar-horizontal" style="visibility: visible;"><div class="simplebar-scrollbar simplebar-visible" style="width: 575px; display: block; transform: translate3d(0px, 0px, 0px);"></div></div> <div class="simplebar-track simplebar-vertical" style="visibility: visible;"><div class="simplebar-scrollbar simplebar-visible" style="height: 0px; display: none;"></div></div></div></div> <div data-codeblock-copy="">复制代码</div> <div data-codeblock-index=""><div data-codeblock-number="1"></div><div data-codeblock-number="2"></div><div data-codeblock-number="3"></div><div data-codeblock-number="4"></div><div data-codeblock-number="5"></div><div data-codeblock-number="6"></div><div data-codeblock-number="7"></div><div data-codeblock-number="8"></div><div data-codeblock-number="9"></div><div data-codeblock-number="10"></div><div data-codeblock-number="11"></div><div data-codeblock-number="12"></div><div data-codeblock-number="13"></div><div data-codeblock-number="14"></div></div></div></div><h3 data-id="heading13" data-type="heading" top="6603">通过 KeyExchange 交换椭圆曲线算法公钥</h3><p data-type="paragraph">ECDH Server Parameter</p><p data-type="paragraph"><br></p><div data-type="codeblock"><div data-codeblock-wrap=""><div data-codeblock-codes=""><div class="simplebar" data-simplebar="init"><div class="simplebar-wrapper" style="margin: 0px;"><div class="simplebar-height-auto-observer-wrapper"><div class="simplebar-height-auto-observer"></div></div> <div class="simplebar-mask"><div class="simplebar-offset" style="right: 0px; bottom: 0px;"><div class="simplebar-content-wrapper" style="height: 100%; overflow: scroll;"><div class="simplebar-content" style="padding: 0px;"><div><pre data-origin="pm_code_preview" lang="text"><code data-type="codeline">Pubkey:04b0ce3c5f2c4a9fbe7c2257c1328438f3378f74e9f528b6e27a00b44eee4c19e5e6b2cb6cab09f796bcf8c05102b2a4bcdc753d91cc4f431f558c845a1ba6f1ce</code><code data-type="codeline"><br></code></pre></div></div></div></div></div> <div class="simplebar-placeholder" style="width: 770px; height: 50px;"></div></div> <div class="simplebar-track simplebar-horizontal" style="visibility: visible;"><div class="simplebar-scrollbar simplebar-visible" style="width: 554px; display: block; transform: translate3d(0px, 0px, 0px);"></div></div> <div class="simplebar-track simplebar-vertical" style="visibility: visible;"><div class="simplebar-scrollbar simplebar-visible" style="height: 0px; display: none;"></div></div></div></div> <div data-codeblock-copy="">复制代码</div> <div data-codeblock-index=""><div data-codeblock-number="1"></div><div data-codeblock-number="2"></div></div></div></div><p data-type="paragraph"><br></p><p data-type="paragraph">记为 <code data-type="codeinline">Spk</code><br></p><p data-type="paragraph"><br></p><p data-type="paragraph">ECDH Client Paramter</p><p data-type="paragraph"><br></p><div data-type="codeblock"><div data-codeblock-wrap=""><div data-codeblock-codes=""><div class="simplebar" data-simplebar="init"><div class="simplebar-wrapper" style="margin: 0px;"><div class="simplebar-height-auto-observer-wrapper"><div class="simplebar-height-auto-observer"></div></div> <div class="simplebar-mask"><div class="simplebar-offset" style="right: 0px; bottom: 0px;"><div class="simplebar-content-wrapper" style="height: 100%; overflow: scroll;"><div class="simplebar-content" style="padding: 0px;"><div><pre data-origin="pm_code_preview" lang="text"><code data-type="codeline">PubKey: 0454e8fbef1503109d619c39be0ccaf89efa3c3962300476465cbc66b15152cd8a900c45d506420f0123e65d8fbb70cb60b497893f81c5c2a0ef2f4bc2da996d9e</code><code data-type="codeline"><br></code></pre></div></div></div></div></div> <div class="simplebar-placeholder" style="width: 770px; height: 50px;"></div></div> <div class="simplebar-track simplebar-horizontal" style="visibility: visible;"><div class="simplebar-scrollbar simplebar-visible" style="width: 550px; display: block; transform: translate3d(0px, 0px, 0px);"></div></div> <div class="simplebar-track simplebar-vertical" style="visibility: visible;"><div class="simplebar-scrollbar simplebar-visible" style="height: 0px; display: none;"></div></div></div></div> <div data-codeblock-copy="">复制代码</div> <div data-codeblock-index=""><div data-codeblock-number="1"></div><div data-codeblock-number="2"></div></div></div></div><p data-type="paragraph"><br></p><p data-type="paragraph">记为 <code data-type="codeinline">Cpk</code><br></p><h3 data-id="heading14" data-type="heading" top="7171">根据 ECDHE 算法计算共享密钥 S(pre-master-secret)</h3><p data-type="paragraph">假设 Server 的使用的椭圆曲线私钥为 Ds, Client 使用的 Dc，计算共享密钥的如下，参考 <a href="https://xie.infoq.cn/link?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F66794410" title="" data-type="link">ECC 椭圆曲线加密算法 - ECDH,ECDHE,ECDSA</a><br></p><p data-type="paragraph"><br></p><p data-type="paragraph">S = Ds * Cpk = Dc * Spk</p><p data-type="paragraph"><br></p><p data-type="paragraph">这个共享密钥 <code data-type="codeinline">S</code> 就是我们在 RFC 文档中看到的 <code data-type="codeinline">pre-master-secret</code><br></p><h3 data-id="heading15" data-type="heading" top="7423">计算 master secret</h3><p data-type="paragraph">计算 <code data-type="codeinline">master secret</code> 过程如下，可参考 <a href="https://xie.infoq.cn/link?target=https%3A%2F%2Ftools.ietf.org%2Fhtml%2Frfc5246%23section-8.1" title="" data-type="link">Computing the Master Secret</a><br></p><p data-type="paragraph"><br></p><div data-type="codeblock"><div data-codeblock-wrap=""><div data-codeblock-codes=""><div class="simplebar" data-simplebar="init"><div class="simplebar-wrapper" style="margin: 0px;"><div class="simplebar-height-auto-observer-wrapper"><div class="simplebar-height-auto-observer"></div></div> <div class="simplebar-mask"><div class="simplebar-offset" style="right: 0px; bottom: 0px;"><div class="simplebar-content-wrapper" style="height: 100%; overflow: scroll;"><div class="simplebar-content" style="padding: 0px;"><div><pre data-origin="pm_code_preview" lang="text"><code data-type="codeline">    master_secret = PRF(pre_master_secret, "master secret", ClientHello.random + ServerHello.random)[0..47];</code><code data-type="codeline"><br></code></pre></div></div></div></div></div> <div class="simplebar-placeholder" style="width: 770px; height: 50px;"></div></div> <div class="simplebar-track simplebar-horizontal" style="visibility: visible;"><div class="simplebar-scrollbar simplebar-visible" style="width: 703px; display: block; transform: translate3d(0px, 0px, 0px);"></div></div> <div class="simplebar-track simplebar-vertical" style="visibility: visible;"><div class="simplebar-scrollbar simplebar-visible" style="height: 0px; display: none;"></div></div></div></div> <div data-codeblock-copy="">复制代码</div> <div data-codeblock-index=""><div data-codeblock-number="1"></div><div data-codeblock-number="2"></div></div></div></div><p data-type="paragraph"><br></p><p data-type="paragraph">计算出来的 <code data-type="codeinline">master_secret</code> 为 48 Bytes，其中 <code data-type="codeinline">ClientHello.random</code> 和 <code data-type="codeinline">ServerHello.random</code> 在 Hello 消息中给出。<code data-type="codeinline">PRF</code> 是伪随机数函数 (pseudorandom function)，在协商的加密套件中给出。</p><h3 data-id="heading16" data-type="heading" top="7761">使用 master_secrete 导出 SRTP 加密参数字节序列</h3><p data-type="paragraph">使用 <a href="https://xie.infoq.cn/link?target=https%3A%2F%2Ftools.ietf.org%2Fhtml%2Frfc5705%23section-4" title="" data-type="link">RFC5705 4. Exporter Definition</a>  给出的计算方式，使用参数 <code data-type="codeinline">master_secret</code>， <code data-type="codeinline">client_random</code>，<code data-type="codeinline">server_random</code> 计算字节序列：</p><p data-type="paragraph"><br></p><div data-type="codeblock"><div data-codeblock-wrap=""><div data-codeblock-codes=""><div class="simplebar" data-simplebar="init"><div class="simplebar-wrapper" style="margin: 0px;"><div class="simplebar-height-auto-observer-wrapper"><div class="simplebar-height-auto-observer"></div></div> <div class="simplebar-mask"><div class="simplebar-offset" style="right: 0px; bottom: 0px;"><div class="simplebar-content-wrapper" style="height: 100%; overflow: hidden scroll;"><div class="simplebar-content" style="padding: 0px;"><div><pre data-origin="pm_code_preview" lang="text"><code data-type="codeline">key_block = PRF(master_secret, "EXTRACTOR-dtls_srtp", client_random + server_random)[length]</code><code data-type="codeline"><br></code></pre></div></div></div></div></div> <div class="simplebar-placeholder" style="width: 770px; height: 50px;"></div></div> <div class="simplebar-track simplebar-horizontal" style="visibility: hidden;"><div class="simplebar-scrollbar simplebar-visible" style="width: 0px; display: none;"></div></div> <div class="simplebar-track simplebar-vertical" style="visibility: visible;"><div class="simplebar-scrollbar simplebar-visible" style="height: 0px; display: none;"></div></div></div></div> <div data-codeblock-copy="">复制代码</div> <div data-codeblock-index=""><div data-codeblock-number="1"></div><div data-codeblock-number="2"></div></div></div></div><p data-type="paragraph"><br></p><p data-type="paragraph">在<a href="https://xie.infoq.cn/link?target=https%3A%2F%2Ftools.ietf.org%2Fhtml%2Frfc5764%23section-4.2" title="" data-type="link"> DTLS-SRTP 4.2. Key Derivation</a> 中描述了需要的字节序列长度。</p><p data-type="paragraph"><br></p><div data-type="codeblock"><div data-codeblock-wrap=""><div data-codeblock-codes=""><div class="simplebar" data-simplebar="init"><div class="simplebar-wrapper" style="margin: 0px;"><div class="simplebar-height-auto-observer-wrapper"><div class="simplebar-height-auto-observer"></div></div> <div class="simplebar-mask"><div class="simplebar-offset" style="right: 0px; bottom: 0px;"><div class="simplebar-content-wrapper" style="height: 100%; overflow: hidden scroll;"><div class="simplebar-content" style="padding: 0px;"><div><pre data-origin="pm_code_preview" lang="text"><code data-type="codeline">2 * (SRTPSecurityParams.master_key_len + SRTPSecurityParams.master_salt_len) bytes of data</code><code data-type="codeline"><br></code></pre></div></div></div></div></div> <div class="simplebar-placeholder" style="width: 770px; height: 50px;"></div></div> <div class="simplebar-track simplebar-horizontal" style="visibility: hidden;"><div class="simplebar-scrollbar simplebar-visible" style="width: 0px; display: none;"></div></div> <div class="simplebar-track simplebar-vertical" style="visibility: visible;"><div class="simplebar-scrollbar simplebar-visible" style="height: 0px; display: none;"></div></div></div></div> <div data-codeblock-copy="">复制代码</div> <div data-codeblock-index=""><div data-codeblock-number="1"></div><div data-codeblock-number="2"></div></div></div></div><p data-type="paragraph"><br></p><p data-type="paragraph">master_key_len 和 master_salt_len 的值，在 <code data-type="codeinline">user_srtp</code> 描述的 profile 中定义。我们的实例中使用的 profile 为 <code data-type="codeinline">SRTP_AES128_CM_HMAC_SHA1_80</code>，对应的 profile 配置为：</p><p data-type="paragraph"><br></p><div data-type="codeblock"><div data-codeblock-wrap=""><div data-codeblock-codes=""><div class="simplebar" data-simplebar="init"><div class="simplebar-wrapper" style="margin: 0px;"><div class="simplebar-height-auto-observer-wrapper"><div class="simplebar-height-auto-observer"></div></div> <div class="simplebar-mask"><div class="simplebar-offset" style="right: 0px; bottom: 0px;"><div class="simplebar-content-wrapper" style="height: 100%; overflow: hidden scroll;"><div class="simplebar-content" style="padding: 0px;"><div><pre data-origin="pm_code_preview" lang="text"><code data-type="codeline">SRTP_AES128_CM_HMAC_SHA1_80</code><code data-type="codeline">        cipher: AES_128_CM</code><code data-type="codeline">        cipher_key_length: 128</code><code data-type="codeline">        cipher_salt_length: 112</code><code data-type="codeline">        maximum_lifetime: 2^31</code><code data-type="codeline">        auth_function: HMAC-SHA1</code><code data-type="codeline">        auth_key_length: 160</code><code data-type="codeline">        auth_tag_length: 80</code><code data-type="codeline"><br></code></pre></div></div></div></div></div> <div class="simplebar-placeholder" style="width: 770px; height: 190px;"></div></div> <div class="simplebar-track simplebar-horizontal" style="visibility: hidden;"><div class="simplebar-scrollbar simplebar-visible" style="width: 0px; display: none;"></div></div> <div class="simplebar-track simplebar-vertical" style="visibility: visible;"><div class="simplebar-scrollbar simplebar-visible" style="height: 0px; display: none;"></div></div></div></div> <div data-codeblock-copy="">复制代码</div> <div data-codeblock-index=""><div data-codeblock-number="1"></div><div data-codeblock-number="2"></div><div data-codeblock-number="3"></div><div data-codeblock-number="4"></div><div data-codeblock-number="5"></div><div data-codeblock-number="6"></div><div data-codeblock-number="7"></div><div data-codeblock-number="8"></div><div data-codeblock-number="9"></div></div></div></div><p data-type="paragraph"><br></p><p data-type="paragraph">也就是我们需要 <code data-type="codeinline">(128/8+112/8)*2 = 60 bytes</code> 字节序列。</p><h3 data-id="heading17" data-type="heading" top="8677">导出 SRTP 密钥</h3><p data-type="paragraph">计算出 SRTP 加密参数字节序列，在 <a href="https://xie.infoq.cn/link?target=https%3A%2F%2Ftools.ietf.org%2Fhtml%2Frfc5764%23section-4.2" title="" data-type="link">DTLS-SRTP 4.2. Key Derivation</a> 描述了字节序列的含义：</p><p data-type="paragraph"><br></p><div data-type="codeblock"><div data-codeblock-wrap=""><div data-codeblock-codes=""><div class="simplebar" data-simplebar="init"><div class="simplebar-wrapper" style="margin: 0px;"><div class="simplebar-height-auto-observer-wrapper"><div class="simplebar-height-auto-observer"></div></div> <div class="simplebar-mask"><div class="simplebar-offset" style="right: 0px; bottom: 0px;"><div class="simplebar-content-wrapper" style="height: 100%; overflow: hidden scroll;"><div class="simplebar-content" style="padding: 0px;"><div><pre data-origin="pm_code_preview" lang="text"><code data-type="codeline">client_write_SRTP_master_key[SRTPSecurityParams.master_key_len]; // 128 bits</code><code data-type="codeline">server_write_SRTP_master_key[SRTPSecurityParams.master_key_len]; // 128 bits</code><code data-type="codeline">client_write_SRTP_master_salt[SRTPSecurityParams.master_salt_len]; // 112 bits</code><code data-type="codeline">server_write_SRTP_master_salt[SRTPSecurityParams.master_salt_len]; // 112 bits</code><code data-type="codeline"><br></code></pre></div></div></div></div></div> <div class="simplebar-placeholder" style="width: 770px; height: 110px;"></div></div> <div class="simplebar-track simplebar-horizontal" style="visibility: hidden;"><div class="simplebar-scrollbar simplebar-visible" style="width: 0px; display: none;"></div></div> <div class="simplebar-track simplebar-vertical" style="visibility: visible;"><div class="simplebar-scrollbar simplebar-visible" style="height: 0px; display: none;"></div></div></div></div> <div data-codeblock-copy="">复制代码</div> <div data-codeblock-index=""><div data-codeblock-number="1"></div><div data-codeblock-number="2"></div><div data-codeblock-number="3"></div><div data-codeblock-number="4"></div><div data-codeblock-number="5"></div></div></div></div><p data-type="paragraph"><br></p><p data-type="paragraph">至此我们得到了，Client 和 Server 使用的 SRTP 加密参数：master_key 和 master_salt.</p><h2 data-id="heading18" data-type="heading" top="9039">DTLS 超时重传</h2><p data-type="paragraph">DTLS 是基于 UDP 的，不可避免会出现丢包，需要重传。如果处理不当，会导致整个通信双方无法建立会话，通话失败。<a href="https://xie.infoq.cn/link?target=https%3A%2F%2Ftools.ietf.org%2Fhtml%2Frfc6347%23section-4.2.4" title="" data-type="link">RFC6347 4.2.4</a> 给出了超时和重传机制。在处理重传时，以下几点需要注意：</p><p data-type="paragraph"><br></p><ol data-type="numberedlist"><li><p data-number="1" data-type="paragraph">在 DTLS 协议中，为了解决丢包和重传问题，新增了  <a href="https://xie.infoq.cn/link?target=https%3A%2F%2Ftools.ietf.org%2Fhtml%2Frfc6347%23section-4.2.2" title="" data-type="link">message_seq.</a> 在发送 DTLS 重传消息时，一定要更新其中的 <code data-type="codeinline">message_seq</code>，这样对端将把包识别是一个重传包，响应正确消息。否则，会默默丢弃这些包，不进行响应。</p></li><li><p data-number="2" data-type="paragraph">当 server 端收到 client 的 FINISHED 消息，并发送 FINISHED 消息给 client，更新 server 状态为协商完成，开始发送 SRTP 数据。此时发送给 client 的 FINISHED 消息，出现丢包。client 收到 SRTP 数据后丢弃。同时，再次发送 FINISHED 消息到 server，server 要正确响应。否则，会导致 DTLS 协商完成的假象，通话失败。</p></li><li><p data-number="3" data-type="paragraph">使用 openssl 1.1.1 之前版本，无法设置 DTLS 超时重传时间，可以超时重传机制不可用，大家开始转向使用 boringssl。openssl 1.1.1 开始版本已经支持设置 DTLS 超时重传，达到和 boringssl 同样的效果。参考 <a href="https://xie.infoq.cn/link?target=https%3A%2F%2Fwww.openssl.org%2Fdocs%2Fman1.1.1%2Fman3%2FDTLS_set_timer_cb.html" title="" data-type="link">DTLS_set_timer_cb</a><br></p></li></ol><h2 data-id="heading19" data-type="heading" top="9475">OpenSSL 的 DTLS 功能</h2><p data-type="paragraph">DTLS 是一个庞大的协议体系，其中包括了各种加密，签名，证书，压缩等多种算法。大多数项目是基于 OpenSSL 或 BoringSSL 实现的 DTLS 功能。在实际项目使用 OpenSSL 的 DTLS 功能，与协商有关的接口总结如下。</p><p data-type="paragraph"><br></p><ol data-type="numberedlist"><li><p data-number="1" data-type="paragraph"><a href="https://xie.infoq.cn/link?target=https%3A%2F%2Fwww.openssl.org%2Fdocs%2Fman1.1.0%2Fman3%2FX509_digest.html" title="" data-type="link">X509_digest</a>，计算证书 fingerprint，用在 SDP 协商中的 <code data-type="codeinline">fingerprint</code> 属性。</p></li><li><p data-number="2" data-type="paragraph"><a href="https://xie.infoq.cn/link?target=https%3A%2F%2Fwww.openssl.org%2Fdocs%2Fmanmaster%2Fman3%2FSSL_CTX_set_cipher_list.html" title="" data-type="link">SSL_CTX_set_cipher_list</a>，设置使用的加密套件，通过设置算法的描述，影响 Hello 消息中的 cipher list。</p></li><li><p data-number="3" data-type="paragraph"><a href="https://xie.infoq.cn/link?target=https%3A%2F%2Fwww.openssl.org%2Fdocs%2Fman1.1.0%2Fman3%2FSSL_CTX_set1_sigalgs_list.html" title="" data-type="link">SSL_CTX_set1_sigalgs_list</a> 设置签名算法。通过设置签名算法的描述，影响 hello 消息中 <code data-type="codeinline">signature_algorithms</code> 扩展。<code data-type="codeinline">signature_algorithms</code> 对 DTLS 的 <code data-type="codeinline">Hello 消息</code> ，<code data-type="codeinline">KeyExchange</code>，<code data-type="codeinline">CerficateVerify</code> 消息。<code data-type="codeinline">signature_algorithms</code> 设置不正确，会出现 internal error，不容易定位问题。</p></li><li><p data-number="4" data-type="paragraph"><a href="https://xie.infoq.cn/link?target=https%3A%2F%2Fwww.openssl.org%2Fdocs%2Fman1.0.2%2Fman3%2FSSL_CTX_set_verify.html" title="" data-type="link">SSL_CTX_set_verify</a> 设置是否校验对端的证书。由于在 RTC 中大多数据情况下使用自签证书，所以对证书的校验，已校验身份是需要的。</p></li><li><p data-number="5" data-type="paragraph"><a href="https://xie.infoq.cn/link?target=https%3A%2F%2Fwww.openssl.org%2Fdocs%2Fman1.1.1%2Fman3%2FSSL_CTX_set_tlsext_use_srtp.html" title="" data-type="link">SSL_CTX_set_tlsext_use_srtp</a> 设置 <code data-type="codeinline">srtp</code> 扩展。srtp 扩展中的 profile，影响 srtp 加密时使用密钥的协商和提取。</p></li><li><p data-number="6" data-type="paragraph"><a href="https://xie.infoq.cn/link?target=https%3A%2F%2Fwww.openssl.org%2Fdocs%2Fman1.1.0%2Fman3%2FSSL_set_options.html" title="" data-type="link">SSL_set_options</a> 使用 <code data-type="codeinline">SSL_OP_NO_QUERY_MTU</code> 和 [SSL_set_mtu] 设置 fragment 的大小。默认 OpenSSL 使用 fragment 较小。通过上面两个接口，设置适合网络情况的 fragment。</p></li><li><p data-number="7" data-type="paragraph"><a href="https://xie.infoq.cn/link?target=https%3A%2F%2Fwww.openssl.org%2Fdocs%2Fman1.1.1%2Fman3%2FDTLS_set_timer_cb.html" title="" data-type="link">DTLS_set_timer_cb</a>，设置超时重传的 Callback，由 callback 设置更合理的超时重传时间。</p></li></ol><p data-type="paragraph"><br></p><p data-type="paragraph">在开源项目 <a href="https://xie.infoq.cn/link?target=https%3A%2F%2Fgithub.com%2Fossrs%2Fsrs" title="" data-type="link">SRS</a> 中已经支持了 WebRTC 的基础协议，对 DTLS 协议感兴趣的同学，可以基于 SRS 快速搭建本机环境，通过调试，进一步加深对 DTLS 的理解。</p><h2 data-id="heading20" data-type="heading" top="10101">总结</h2><p data-type="paragraph">本文通过 WebRTC 中 SRTP 密钥的协商过程，来说明 DTLS 在 WebRTC 中的应用。DTLS 协议设计的各个加密算法的知识较多，加上 TLS 消息的在各种应用场景中的扩展，难免有理解和认知不到的地方，还需要进一步深入探索。</p><h2 data-id="heading21" data-type="heading" top="10235">参考文献</h2><ol data-type="numberedlist"><li><p data-number="1" data-type="paragraph"><a href="https://xie.infoq.cn/link?target=https%3A%2F%2Ftools.ietf.org%2Fhtml%2Frfc5246" title="" data-type="link">TLS 1.2</a><br></p></li><li><p data-number="2" data-type="paragraph"><a href="https://xie.infoq.cn/link?target=https%3A%2F%2Ftools.ietf.org%2Fhtml%2Frfc6347" title="" data-type="link">DTLS 1.2</a><br></p></li><li><p data-number="3" data-type="paragraph"><a href="https://xie.infoq.cn/link?target=https%3A%2F%2Ftools.ietf.org%2Fhtml%2Frfc7627" title="" data-type="link">TLS Session Hash Extension</a><br></p></li><li><p data-number="4" data-type="paragraph"><a href="https://xie.infoq.cn/link?target=https%3A%2F%2Ftools.ietf.org%2Fhtml%2Frfc4145" title="" data-type="link">TCP-Based Media Transport in the Session Description Protocol</a><br></p></li><li><p data-number="5" data-type="paragraph"><a href="https://xie.infoq.cn/link?target=https%3A%2F%2Fwww.iana.org%2Fassignments%2Ftls-extensiontype-values%2Ftls-extensiontype-values.xhtml" title="" data-type="link">TLS Extension</a><br></p></li><li><p data-number="6" data-type="paragraph"><a href="https://xie.infoq.cn/link?target=https%3A%2F%2Ftools.ietf.org%2Fhtml%2Frfc5764" title="" data-type="link">SRTP Extension for DTLS </a><br></p></li><li><p data-number="7" data-type="paragraph"><a href="https://xie.infoq.cn/link?target=https%3A%2F%2Fwww.openssl.org%2Fdocs%2Fman1.1.1%2Fman3" title="" data-type="link">OpenSSL Man</a><br></p></li><li><p data-number="8" data-type="paragraph"><a href="https://xie.infoq.cn/link?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F36326221" title="" data-type="link">ECC 椭圆曲线加密算法 - 介绍</a><br></p></li><li><p data-number="9" data-type="paragraph"><a href="https://xie.infoq.cn/link?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F44743146" title="" data-type="link">ECC 椭圆曲线加密算法 - 有限域和离散对数</a><br></p></li><li><p data-number="10" data-type="paragraph"><a href="https://xie.infoq.cn/link?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F66794410" title="" data-type="link">ECC 椭圆曲线加密算法 - ECDH、ECDHE 和 ECDSA</a><br></p></li></ol><p data-type="paragraph"><br></p></div></div><div data-v-026a1842="" data-v-499c3731="" class="selection-operation-bar note-bar popup-note-menu down" style="top: 13398.2px; left: 247.117px;"><div data-v-026a1842="" class="arrow down" style="left: 94px;"></div><div data-v-026a1842="" class="main"><div data-v-026a1842="" class="menu line"><i data-v-a949bb52="" data-v-026a1842="" class="com-icon iconfont icon-hover" style="font-size: 20px; color: rgb(255, 255, 255);"></i><span data-v-026a1842="" class="text">划线</span></div><!----><div data-v-026a1842="" class="menu comment"><i data-v-a949bb52="" data-v-026a1842="" class="com-icon iconfont icon-hover" style="font-size: 20px; color: rgb(255, 255, 255);"></i><span data-v-026a1842="" class="text">评论</span></div><div data-v-026a1842="" class="menu copy"><i data-v-a949bb52="" data-v-026a1842="" class="com-icon iconfont icon-hover" style="font-size: 20px; color: rgb(255, 255, 255);"></i><span data-v-026a1842="" class="text">复制</span></div></div></div></div></div><div data-v-0af02394="" data-v-b110a92e="" class="author-information after-content"><div data-v-0af02394="" data-v-b110a92e="" class="row"><span data-v-0af02394="" data-v-b110a92e="" class="date">发布于: 2021 年 05 月 07 日</span><span data-v-0af02394="" data-v-b110a92e="" class="views">阅读数: 1840</span></div></div><div data-v-0af02394="" data-v-b110a92e="" class="copyright"><p data-v-0af02394="" data-v-b110a92e="">版权声明: 本文为 InfoQ 作者【阿里云视频云】的原创文章。</p><p data-v-0af02394="" data-v-b110a92e="">原文链接:【<a href="https://xie.infoq.cn/article/182f59ec77450fde2f87e2354" target="_blank">https://xie.infoq.cn/article/182f59ec77450fde2f87e2354</a>】。</p><p data-v-0af02394="" data-v-b110a92e="">本文遵守【CC-BY 4.0】协议，转载请保留原文出处及本版权声明。</p></div><!----><div data-v-4300d745="" data-v-0af02394="" class="com-label-list tag-list" data-v-b110a92e=""><a data-v-4426e0e8="" data-v-4300d745="" href="https://xie.infoq.cn/tag/209" com-label-title="" class="com-label-title">阿里云</a><a data-v-4426e0e8="" data-v-4300d745="" href="https://xie.infoq.cn/tag/662" com-label-title="" class="com-label-title">WebRTC</a><a data-v-4426e0e8="" data-v-4300d745="" href="https://xie.infoq.cn/tag/2838" com-label-title="" class="com-label-title">通信协议</a><a data-v-4426e0e8="" data-v-4300d745="" href="https://xie.infoq.cn/tag/12587" com-label-title="" class="com-label-title">视频云</a><a data-v-4426e0e8="" data-v-4300d745="" href="https://xie.infoq.cn/tag/13987" com-label-title="" class="com-label-title">流媒体传输</a></div><div data-v-5c7b5c28="" data-v-0af02394="" author-card="" class="com-author-card author-info" data-v-b110a92e=""><div data-v-5c7b5c28="" class="author-card"><div data-v-5c7b5c28="" class="top"><div data-v-5c7b5c28="" class="avatar"><div data-v-6f271b48="" data-v-5c7b5c28="" class="com-avatar-wrap"><img data-v-6f271b48="" src="./详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区_files/d6b18f0e.jpg" alt="用户头像" class="com-avatar" style="width: 55px; height: 55px;"><!----></div></div><div data-v-5c7b5c28="" class="info"><div data-v-5c7b5c28="" class="top"><h3 data-v-5c7b5c28="" class="author-name"><span data-v-3bc80670="" data-v-6281d13f="" data-v-5c7b5c28="" class="ctn"><a data-v-3bc80670="" rel="nofollow" com-author-name="" class="com-author-name">阿里云视频云</a><!----></span></h3><div data-v-d2847db8="" data-v-5c7b5c28="" gk-button="" gkbtn-color="unfollow" gkbtn-size="small" class="geek-foll-btn Button_button_3onsJ" follow-button="" data-follow="0"><i data-v-5c7b5c28="" class="iconfont"></i>关注</div></div><p data-v-5c7b5c28="" class="mood"> 公众号：视频云技术 <span data-v-5c7b5c28="" class="dot"></span> 2020.10.20 加入</p></div></div><!----><p data-v-5c7b5c28="" class="intro">「视频云技术」你最值得关注的音视频技术公众号，每周推送来自阿里云一线的实践技术文章，在这里与音视频领域一流工程师交流切磋。</p></div></div><div data-v-72733e04="" data-v-0af02394="" class="widget-operation-bottom widget-operation inner" wxshareurl="https://xie.infoq.cn/article/182f59ec77450fde2f87e2354" data-v-b110a92e=""><!----><div data-v-72733e04="" class="like btn"><i data-v-72733e04="" class="iconfont"></i><!----></div><div data-v-72733e04="" class="favorite btn"><i data-v-72733e04="" class="iconfont"></i></div><!----><div data-v-72733e04="" class="weixin btn"><span data-v-72733e04="" class="gkui-popup share-popup-top share-popup"><i data-v-72733e04="" class="iconfont"></i><!----></span></div><div data-v-72733e04="" class="weibo btn"><i data-v-72733e04="" class="iconfont"></i></div><div data-v-72733e04="" class="horde btn"><i data-v-72733e04="" class="iconfont"></i></div><div data-v-72733e04="" data-self="2" data-label="举报" class="extra btn"><i data-v-72733e04="" class="iconfont"></i></div></div><div data-v-1ee27d2c="" data-v-0af02394="" class="article-comment-block comment-list-wrap" data-v-b110a92e=""><div data-v-1ee27d2c="" class="comment-list"><h2 data-v-1ee27d2c="">评论 <!----></h2><div data-v-1ee27d2c="" class="comment-form"><div data-v-1ee27d2c="" class="comment-input no-reference"><div data-v-045f148c="" data-v-1ee27d2c="" contenteditable="plaintext-only" spellcheck="false" placeholder="快抢沙发！虚位以待" class="textarea comment-textarea empty"></div> <!----></div><div data-v-1ee27d2c="" class="comment-operation"><div data-v-1ee27d2c="" gk-button="" gkbtn-color="green" gkbtn-size="normal" disabled="disabled" class="comment-btn Button_button_3onsJ"> 发布 </div></div></div><div data-v-1ee27d2c="" class="empty-comment"> 暂无评论 </div></div></div><!----></div><!----><div data-v-fc049942="" data-v-0af02394="" id="gk-layer" gkmodal-color="common" class="report-modal Modal_gk-modal_3ly5T" data-v-b110a92e=""><!----><!----></div><div data-v-355438c6="" data-v-0af02394="" id="gk-layer" gkmodal-color="base" class="share-weixin-modal Modal_gk-modal_3ly5T" data-v-b110a92e=""><!----><!----></div><div data-v-17597960="" data-v-0af02394="" id="gk-layer" gkmodal-color="base" class="modal-share-horde Modal_gk-modal_3ly5T" data-v-b110a92e=""><!----><!----></div><!----></div><!----></div><div data-v-b110a92e="" id="check-bottom-bar"></div><div data-v-b110a92e="" layout-footer-wrap="" class="layout-footer-wrap"><div data-v-3f7820d9="" data-v-b110a92e="" class="footer layout-footer"><ul data-v-3f7820d9="" class="layout-content"><li data-v-3f7820d9="" class="theme"><div data-v-3f7820d9="" class="logo"><img data-v-3f7820d9="" src="./详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区_files/logo.3bdee6e4.png" alt="logo"><p data-v-3f7820d9="">促进软件开发及相关领域知识与创新的传播</p></div></li><li data-v-3f7820d9=""><dl data-v-3f7820d9="" class="footer-nav"><dt data-v-3f7820d9="">InfoQ</dt><dd data-v-3f7820d9=""><!----><a data-v-3f7820d9="" href="https://www.infoq.cn/about" target="_blank" rel="noopener nofollow">关于我们</a></dd><dd data-v-3f7820d9=""><!----><a data-v-3f7820d9="" href="https://www.infoq.cn/contribute" target="_blank" rel="noopener nofollow">我要投稿</a></dd><dd data-v-3f7820d9=""><!----><a data-v-3f7820d9="" href="https://www.geekbang.org/partner" target="_blank" rel="noopener nofollow">合作伙伴</a></dd><dd data-v-3f7820d9=""><!----><a data-v-3f7820d9="" href="https://xie.infoq.cn/link?target=https%3A%2F%2Fwww.lagou.com%2Fgongsi%2Fj43775.html" target="_blank" rel="noopener nofollow">加入我们</a></dd><dd data-v-3f7820d9=""><!----><a data-v-3f7820d9="" href="https://infoq.cn/official/account" target="_blank" rel="noopener nofollow">关注我们</a></dd></dl></li><li data-v-3f7820d9=""><dl data-v-3f7820d9="" class="footer-nav"><dt data-v-3f7820d9="">联系我们</dt><dd data-v-3f7820d9=""><!----><a data-v-3f7820d9="" href="mailto:editors@geekbang.com" target="_blank" rel="noopener nofollow">内容投稿：editors@geekbang.com</a></dd><dd data-v-3f7820d9=""><!----><a data-v-3f7820d9="" href="mailto:hezuo@geekbang.com" target="_blank" rel="noopener nofollow">业务合作：hezuo@geekbang.com</a></dd><dd data-v-3f7820d9=""><!----><a data-v-3f7820d9="" href="mailto:feedback@geekbang.com" target="_blank" rel="noopener nofollow">反馈投诉：feedback@geekbang.com</a></dd><dd data-v-3f7820d9=""><!----><a data-v-3f7820d9="" href="mailto:zhaopin@geekbang.com" target="_blank" rel="noopener nofollow">加入我们：zhaopin@geekbang.com</a></dd><dd data-v-3f7820d9=""><!----><span data-v-3f7820d9="">联系电话：010-64738142</span></dd><dd data-v-3f7820d9=""><!----><span data-v-3f7820d9="">地址：北京市朝阳区叶青大厦北园</span></dd></dl></li><li data-v-3f7820d9=""><dl data-v-3f7820d9="" class="footer-nav"><dt data-v-3f7820d9="">InfoQ 近期会议</dt><dd data-v-3f7820d9=""><img data-v-3f7820d9="" src="./详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区_files/628b5e750e918f52cda61a19fdc186f5.png" alt="会议图片"><a data-v-3f7820d9="" href="https://gmtc.infoq.cn/2022/beijing/?utm_source=infoq&amp;utm_medium=footer" target="_blank" rel="noopener nofollow">GMTC全球大前端技术大会 6月10-11日</a></dd><dd data-v-3f7820d9=""><img data-v-3f7820d9="" src="./详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区_files/682e88b72d998d472686410a05c67986.png" alt="会议图片"><a data-v-3f7820d9="" href="https://archsummit.infoq.cn/2022/shanghai/?utm_source=infoq&amp;utm_medium=footer" target="_blank" rel="noopener nofollow">ArchSummit全球架构师峰会 6月19-20日</a></dd><dd data-v-3f7820d9=""><img data-v-3f7820d9="" src="./详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区_files/628b5e750e918f52cda61a19fdc186f5.png" alt="会议图片"><a data-v-3f7820d9="" href="https://qcon.infoq.cn/2022/beijing/?utm_source=infoq&amp;utm_medium=footer" target="_blank" rel="noopener nofollow">QCon全球软件开发大会 6月22-24日</a></dd><dd data-v-3f7820d9=""><img data-v-3f7820d9="" src="./详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区_files/628b5e750e918f52cda61a19fdc186f5.png" alt="会议图片"><a data-v-3f7820d9="" href="https://archsummit.infoq.cn/2021/beijing/?utm_source=infoq&amp;utm_medium=footer" target="_blank" rel="noopener nofollow">ArchSummit全球架构师峰会 6月24-25日</a></dd><dd data-v-3f7820d9=""><img data-v-3f7820d9="" src="./详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区_files/628b5e750e918f52cda61a19fdc186f5.png" alt="会议图片"><a data-v-3f7820d9="" href="https://pcon.infoq.cn/2021/beijing/?utm_source=infoq&amp;utm_medium=footer" target="_blank" rel="noopener nofollow">PCon全球产品创新大会 6月24-25日</a></dd><dd data-v-3f7820d9=""><img data-v-3f7820d9="" src="./详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区_files/e9389010abc33c8414653cdffd281a55.png" alt="会议图片"><a data-v-3f7820d9="" href="https://archsummit.infoq.cn/2022/shenzhen/?utm_source=infoq&amp;utm_medium=footer" target="_blank" rel="noopener nofollow">ArchSummit全球架构师峰会 7月15-16日</a></dd><dd data-v-3f7820d9=""><img data-v-3f7820d9="" src="./详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区_files/628b5e750e918f52cda61a19fdc186f5.png" alt="会议图片"><span data-v-3f7820d9="">PCon全球产品创新大会 8月19-20日</span></dd></dl></li><li data-v-3f7820d9=""><dl data-v-3f7820d9="" class="footer-nav"><dt data-v-3f7820d9="">全球 InfoQ</dt><dd data-v-3f7820d9=""><img data-v-3f7820d9="" src="./详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区_files/55cd81623e36f5ab7a7db74d60b74838.png" alt="会议图片"><a data-v-3f7820d9="" href="https://www.infoq.com/" target="_blank" rel="noopener nofollow">InfoQ  En</a></dd><dd data-v-3f7820d9=""><img data-v-3f7820d9="" src="./详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区_files/95fe851c02c86120e9037eada6a36d13.png" alt="会议图片"><a data-v-3f7820d9="" href="https://www.infoq.com/jp/" target="_blank" rel="noopener nofollow">InfoQ Jp</a></dd><dd data-v-3f7820d9=""><img data-v-3f7820d9="" src="./详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区_files/2aa440b6d94e94f64c508f16da38933e.png" alt="会议图片"><a data-v-3f7820d9="" href="http://www.infoq.com/fr/" target="_blank" rel="noopener nofollow">InfoQ Fr</a></dd><dd data-v-3f7820d9=""><img data-v-3f7820d9="" src="./详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区_files/4e737ce82bc7c8a1c2f2307bcea9a11e.png" alt="会议图片"><a data-v-3f7820d9="" href="http://www.infoq.com/br/" target="_blank" rel="noopener nofollow">InfoQ Br</a></dd></dl></li></ul><div data-v-3f7820d9="" class="copyright"> Copyright © 2022, Geekbang Technology Ltd. All rights reserved. 极客邦控股（北京）有限公司 | <a data-v-3f7820d9="" target="_blank" href="https://xie.infoq.cn/link?target=http%3A%2F%2Fwww.beian.miit.gov.cn%2F" class="icp"> 京 ICP 备 16027448 号 - 5</a><a data-v-3f7820d9="" target="_blank" href="https://xie.infoq.cn/link?target=http%3A%2F%2Fwww.beian.gov.cn%2Fportal%2FregisterSystemInfo%3Frecordcode%3D11010502039052"><img data-v-3f7820d9="" src="./详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区_files/beian.d0289dc0.png" alt="京公网安备"><span data-v-3f7820d9="">京公网安备 11010502039052号</span></a></div></div></div><div data-v-b110a92e="" id="gk-layer" gkmodal-color="common" class="offline-modal Modal_gk-modal_3ly5T"><!----><!----></div></div>
<img src="./详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区_files/logo-121-75.yuij86g.png" alt="详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区" style="display: none;">
<script>
    (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date(); a = s.createElement(o),
            m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
    })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'UA-103082599-11', 'auto');
    ga('send', 'pageview');
</script>
<script>
    var isRobot = /ltdgeekbang/i.test(window.navigator.userAgent.toLowerCase())
    if (!isRobot) {
        var __gBaiduSiteIdConfig__ = {
            infoq: '094d2af1d9a57fd9249b3fa259428445',
            xie: 'c53c258392315152cda6662d99774537'
        };
        var _hmt = _hmt || [];
        _hmt.push(['_setAccount', __gBaiduSiteIdConfig__.infoq]);
        _hmt.push(['_setAutoPageview', true]);
        _hmt.push(['_setAccount', __gBaiduSiteIdConfig__.xie]);
        _hmt.push(['_setAutoPageview', true]);

        (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?" + __gBaiduSiteIdConfig__.infoq;
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
        
        (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?" + __gBaiduSiteIdConfig__.xie;
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
        
    }
</script>
<script>
    
    var isSmart = /swan\//.test(window.navigator.userAgent) || /^webswan-/.test(window.name);
    if (isSmart) {
        var smart = document.createElement("script");
        smart.src = "https://b.bdstatic.com/searchbox/icms/searchbox/js/swan-2.0.21.js";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(smart, s);
    }
</script>
<script>
    (function(para) {
        var p = para.sdk_url, n = para.name, w = window, d = document, s = 'script',x = null,y = null;
        if(typeof(w['sensorsDataAnalytic201505']) !== 'undefined') {
            return false;
        }
        w['sensorsDataAnalytic201505'] = n;
        w[n] = w[n] || function(a) {return function() {(w[n]._q = w[n]._q || []).push([a, arguments]);}};
        var ifs = ['track','quick','register','registerPage','registerOnce','trackSignup', 'trackAbtest', 'setProfile','setOnceProfile','appendProfile', 'incrementProfile', 'deleteProfile', 'unsetProfile', 'identify','login','logout','trackLink','clearAllRegister','getAppStatus'];
        for (var i = 0; i < ifs.length; i++) {
            w[n][ifs[i]] = w[n].call(null, ifs[i]);
        }
        if (!w[n]._t) {
            x = d.createElement(s), y = d.getElementsByTagName(s)[0];
            x.async = 1;
            x.src = p;
            x.setAttribute('charset','UTF-8');
            w[n].para = para;
            y.parentNode.insertBefore(x, y);
        }
    })({
        sdk_url: 'https://static.sensorsdata.cn/sdk/1.15.15/sensorsdata.min.js',
        heatmap_url: 'https://static.sensorsdata.cn/sdk/1.15.15/heatmap.min.js',
        name: 'sensors',
        server_url: 'https://sscentry.geekbang.org/sa?project=production',
        show_log: false,
        is_track_single_page: true,
        heatmap: {
            clickmap: 'not_collect',
            scroll_notice_map: 'not_collect'
        },
        preset_properties: {
            latest_referrer_host: true,
            latest_landing_page: true,
            url: true
        }
    });
</script>

    <script type="text/javascript" src="./详解 WebRTC 传输安全机制：一文读懂 DTLS 协议_阿里云_阿里云视频云_InfoQ写作社区_files/main.js.下载"></script>



<div data-v-3710ffdc="" id="gkui-message-list" style="top: 24px;"><span data-v-3710ffdc=""></span></div><div id="gkui-modal-controller"><!----></div><div class="common-login-modal"><div data-v-467cbcd0="" id="gk-layer" gkmodal-color="base" class="modal-login Modal_gk-modal_3ly5T"><!----><!----></div><div data-v-5070518a="" id="gk-layer" gkmodal-color="base" class="modal-guide Modal_gk-modal_3ly5T"><!----><!----></div><div data-v-4e23a88d="" id="gk-layer" gkmodal-color="base" class="modal-receive-success Modal_gk-modal_3ly5T"><!----><!----></div><div data-v-b3d76520="" id="gk-layer" gkmodal-color="base" class="modal-rebind Modal_gk-modal_3ly5T"><!----><!----></div></div><div tabindex="-1" role="dialog" aria-hidden="true" class="pswp pswp--zoom-allowed"><div class="pswp__bg"></div><div class="pswp__scroll-wrap"><div class="pswp__container"><div class="pswp__item"></div><div class="pswp__item"></div><div class="pswp__item"></div></div><div class="pswp__ui pswp__ui--hidden"><div class="pswp__top-bar"><div class="pswp__counter"></div><button title="Close (Esc)" class="pswp__button pswp__button--close"></button><button title="Share" class="pswp__button pswp__button--share"></button><button title="Toggle fullscreen" class="pswp__button pswp__button--fs"></button><button title="Zoom in/out" class="pswp__button pswp__button--zoom"></button><div class="pswp__preloader"><div class="pswp__preloader__icn"><div class="pswp__preloader__cut"><div class="pswp__preloader__donut"></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class="pswp__share-tooltip"></div></div><button title="Previous (arrow left)" class="pswp__button pswp__button--arrow--left"></button><button title="Next (arrow right)" class="pswp__button pswp__button--arrow--right"></button><div class="pswp__caption"><div class="pswp__caption__center"></div></div></div></div></div><div><div id="gk-layer" gkmodal-color="logPhone" class="Modal_gk-modal_3ly5T" lockbody="true"><!----><!----></div></div><!----><!----><img src="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEHAAEALAAAAAABAAEAAAICTAEAOw==" id="page-complete" style="display: none;"></body></html>